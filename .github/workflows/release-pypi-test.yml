name: "Pypi Release - Test"

on:
    workflow_dispatch:
      inputs:
        opt_build_type:
          type: choice
          description: Build Type
          options:
          - py setup.py
          - py build

# alias python='python3'

jobs:
    build-n-publish:
        name: Build and publish Python ğŸ distributions ğŸ“¦ to PyPI and TestPyPI
        runs-on: ubuntu-latest
    
        steps:
        - name: âœ… Start
          run: | 
                echo "Starting build: ${{ github.event.inputs.opt_build_type }}" / ${{ inputs.opt_build_type }}

        - name: â˜‘ï¸ Checkout
          uses: actions/checkout@v3
        - name: ğŸ Set up Python
          uses: actions/setup-python@v4
          with:
            python-version: "3.x"
        - name: ğŸ Install Build Tools
          run: |
            python -m pip install --upgrade pip
            pip install setuptools wheel twine build
        - name: â˜¸ï¸ Build tarball
          run: |
            if [ "${{ github.event.inputs.opt_build_type }}" = "py setup.py" ]; then
              python setup.py sdist
            fi

            if [ "${{ github.event.inputs.opt_build_type }}" = "py build" ]; then
              python -m build . --sdist
            fi